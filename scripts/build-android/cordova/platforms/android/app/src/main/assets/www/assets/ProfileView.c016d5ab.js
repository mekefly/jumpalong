import{g as ve,c as q,a as be}from"./Contact.a56396af.js";import{g as oe,a as ye}from"./user.a4fb9555.js";import{p as ue,a as ge,i as he,j as ke,k as we}from"./Content.167969e1.js";import{E as ie}from"./Ellipsis.e5fc37f4.js";import{l as xe,c as ae,cp as $e,b as Z,cq as Fe,d as re,f as M,u as Ee,ap as z,m as le,n as v,h as ce,dj as Ce,aw as Le,o as ze,q as Be,dg as Re,aE as Se,dk as ee,aG as de,dl as Pe,b4 as Me,w as je,v as De,j as W,aJ as Ue,bv as T,y,z as R,A as c,aP as C,H as s,C as e,F as U,D as P,G as K,I as S,L as Q,J as pe,U as B,a9 as I,dh as Oe,_ as N,O as $,bs as ne,br as Ke,c5 as Ie,aZ as Ve,bJ as Y,dm as Ae,aY as Ne,Q as Te,d1 as We}from"./index.de60ca02.js";import{l as He,p as Ge}from"./use.9a2f80b1.js";import{t as Je}from"./Tag.be4c6b01.js";import{a as qe,_ as fe}from"./ListItem.e483f558.js";import{u as Ye,S as Qe}from"./Scrollbar.12236074.js";import{_ as Xe}from"./PostList.vue_vue_type_script_setup_true_lang.5af940c6.js";import{a as Ze}from"./RelayAddButton.vue_vue_type_script_setup_true_lang.8bc3537c.js";import{a as et}from"./AddButton.vue_vue_type_script_setup_true_lang.afbaf71a.js";import{_ as tt,a as ot}from"./RelayWritableButton.vue_vue_type_script_setup_true_lang.2d070553.js";import{_ as nt,a as at}from"./Tabs.f2f464ec.js";import{u as rt,r as se}from"./naiveUi.3b033277.js";import{_ as lt}from"./UserMetadataEditing.vue_vue_type_script_setup_true_lang.c3ea86e1.js";import{_ as te}from"./Space.b6c95bbe.js";import{_ as st}from"./Dropdown.fb4da711.js";import{a as ut}from"./nostr.656ef4cd.js";import"./getCacheStaff.283a43f7.js";import"./event.e2dea496.js";import"./autoAddRelayurlByEventIdStaff.73b12553.js";import"./channel.8f39afd5.js";import"./ContentBlacklistView.8c70f668.js";import"./Input.cc4eb912.js";import"./Icon.919891f2.js";import"./UserLink.vue_vue_type_script_setup_true_lang.c1cc397a.js";import"./DrawerContent.4dbf8f07.js";import"./RelayInfoView.e65832c0.js";import"./use-theme-vars.c1c11cee.js";import"./Popselect.8f632a4a.js";import"./create.2deeaf6a.js";import"./Checkmark.93029895.js";import"./Empty.316516f4.js";import"./create-ref-setter.fe4a2903.js";import"./Scrollbar.193872ed.js";import"./PapawList.vue_vue_type_script_setup_true_lang.675ba8f6.js";import"./composables.0dd76f13.js";import"./UploadButton.vue_vue_type_script_setup_true_lang.d95cad25.js";import"./CloudUpload.92ef62d3.js";import"./get-slot.4ceacf82.js";const it=xe("n-avatar-group"),ct=ae("avatar",`
 width: var(--n-merged-size);
 height: var(--n-merged-size);
 color: #FFF;
 font-size: var(--n-font-size);
 display: inline-flex;
 position: relative;
 overflow: hidden;
 text-align: center;
 border: var(--n-border);
 border-radius: var(--n-border-radius);
 --n-merged-color: var(--n-color);
 background-color: var(--n-merged-color);
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[$e(Z("&","--n-merged-color: var(--n-color-modal);")),Fe(Z("&","--n-merged-color: var(--n-color-popover);")),Z("img",`
 width: 100%;
 height: 100%;
 `),re("text",`
 white-space: nowrap;
 display: inline-block;
 position: absolute;
 left: 50%;
 top: 50%;
 `),ae("icon",`
 vertical-align: bottom;
 font-size: calc(var(--n-merged-size) - 6px);
 `),re("text","line-height: 1.25")]),dt=Object.assign(Object.assign({},ce.props),{size:[String,Number],src:String,circle:{type:Boolean,default:void 0},objectFit:String,round:{type:Boolean,default:void 0},bordered:{type:Boolean,default:void 0},onError:Function,fallbackSrc:String,intersectionObserverOptions:Object,lazy:Boolean,onLoad:Function,renderPlaceholder:Function,renderFallback:Function,imgProps:Object,color:String}),_e=M({name:"Avatar",props:dt,setup(r){const{mergedClsPrefixRef:f,inlineThemeDisabled:u}=Ee(r),i=z(!1);let a=null;const m=z(null),o=z(null),p=()=>{const{value:t}=m;if(t&&(a===null||a!==t.innerHTML)){a=t.innerHTML;const{value:_}=o;if(_){const{offsetWidth:x,offsetHeight:b}=_,{offsetWidth:E,offsetHeight:V}=t,O=.9,A=Math.min(x/E*O,b/V*O,1);t.style.transform=`translateX(-50%) translateY(-50%) scale(${A})`}}},l=le(it,null),n=v(()=>{const{size:t}=r;if(t)return t;const{size:_}=l||{};return _||"medium"}),g=ce("Avatar","-avatar",ct,Ce,r,f),h=le(Je,null),d=v(()=>{if(l)return!0;const{round:t,circle:_}=r;return t!==void 0||_!==void 0?t||_:h?h.roundRef.value:!1}),k=v(()=>l?!0:r.bordered||!1),w=t=>{var _;if(!j.value)return;i.value=!0;const{onError:x,imgProps:b}=r;(_=b==null?void 0:b.onError)===null||_===void 0||_.call(b,t),x&&x(t)};Le(()=>r.src,()=>i.value=!1);const L=v(()=>{const t=n.value,_=d.value,x=k.value,{color:b}=r,{self:{borderRadius:E,fontSize:V,color:O,border:A,colorModal:H,colorPopover:G},common:{cubicBezierEaseInOut:J}}=g.value;let X;return typeof t=="number"?X=`${t}px`:X=g.value.self[ze("height",t)],{"--n-font-size":V,"--n-border":x?A:"none","--n-border-radius":_?"50%":E,"--n-color":b||O,"--n-color-modal":b||H,"--n-color-popover":b||G,"--n-bezier":J,"--n-merged-size":`var(--n-avatar-size-override, ${X})`}}),F=u?Be("avatar",v(()=>{const t=n.value,_=d.value,x=k.value,{color:b}=r;let E="";return t&&(typeof t=="number"?E+=`a${t}`:E+=t[0]),_&&(E+="b"),x&&(E+="c"),b&&(E+=Re(b)),E}),L,r):void 0,j=z(!r.lazy);Se(()=>{if(ee)return;let t;const _=de(()=>{t==null||t(),t=void 0,r.lazy&&(t=Pe(o.value,r.intersectionObserverOptions,j))});Me(()=>{_(),t==null||t()})});const D=z(!r.lazy);return{textRef:m,selfRef:o,mergedRoundRef:d,mergedClsPrefix:f,fitTextTransform:p,cssVars:u?void 0:L,themeClass:F==null?void 0:F.themeClass,onRender:F==null?void 0:F.onRender,hasLoadError:i,handleError:w,shouldStartLoading:j,loaded:D,mergedOnLoad:t=>{var _;const{onLoad:x,imgProps:b}=r;x==null||x(t),(_=b==null?void 0:b.onLoad)===null||_===void 0||_.call(b,t),D.value=!0}}},render(){var r,f;const{$slots:u,src:i,mergedClsPrefix:a,lazy:m,onRender:o,mergedOnLoad:p,shouldStartLoading:l,loaded:n,hasLoadError:g}=this;o==null||o();let h;const d=!n&&!g&&(this.renderPlaceholder?this.renderPlaceholder():(f=(r=this.$slots).placeholder)===null||f===void 0?void 0:f.call(r));return this.hasLoadError?h=this.renderFallback?this.renderFallback():je(u.fallback,()=>[W("img",{src:this.fallbackSrc,style:{objectFit:this.objectFit}})]):h=De(u.default,k=>{if(k)return W(Ue,{onResize:this.fitTextTransform},{default:()=>W("span",{ref:"textRef",class:`${a}-avatar__text`},k)});if(i){const{imgProps:w}=this;return W("img",Object.assign(Object.assign({},w),{loading:ee&&!this.intersectionObserverOptions&&m?"lazy":"eager",src:ee||l||n?i:void 0,onLoad:p,"data-image-src":i,onError:this.handleError,style:[w==null?void 0:w.style,{objectFit:this.objectFit},d?{height:"0",width:"0",visibility:"hidden",position:"absolute"}:""]}))}}),W("span",{ref:"selfRef",class:[`${a}-avatar`,this.themeClass],style:this.cssVars},h,m&&d)}}),pt={class:"flex flex-col ml-4 flex-1 shrink-1 w-full"},me=M({__name:"FollowItem",props:{pubkey:null,name:null,about:null},setup(r){const f=r,{pubkey:u,name:i,about:a}=T(f),[m,o]=He(()=>oe(u.value)),p=v(()=>{var l;return(l=m.value)==null?void 0:l.feat.useMetadata()});return(l,n)=>{const g=_e,h=ie,d=qe;return y(),R(d,{class:"cursor-pointer"},{default:c(()=>{var k,w,L,F,j,D;return[C("div",{ref_key:"target",ref:o,class:"flex items-center"},[s(g,{class:"ml-4",size:"small",src:(w=(k=e(p))==null?void 0:k.picture)!=null?w:e(ue),round:"",onClick:n[0]||(n[0]=()=>l.$router.push(`/profile/${e(u)}`))},null,8,["src"]),C("div",pt,[C("div",{class:"text-xl",onClick:n[1]||(n[1]=()=>l.$router.push(`/profile/${e(u)}`))},U((j=(F=e(i))!=null?F:(L=e(p))==null?void 0:L.name)!=null?j:e(u).slice(0,10)),1),(D=e(p))!=null&&D.about?(y(),R(h,{key:0,style:{fontSize:"10px"}},{default:c(()=>{var t;return[P(U((t=e(a))!=null?t:e(p).about),1)]}),_:1})):K("",!0)])],512)]}),_:1})}}}),ft={class:"p-4 box-border"},_t=M({__name:"Follow",props:{pubkey:null,urls:null},setup(r){const f=r,{pubkey:u,urls:i}=T(f),a=v(()=>ve(u.value,{urls:i==null?void 0:i.value})),m=v(()=>u.value===B.value.publicKey?q.getContactConfiguration():a.value.feat.getContactList());return(o,p)=>(y(),S("div",ft,[s(e(fe),null,{default:c(()=>[(y(!0),S(Q,null,pe(e(m),l=>(y(),R(me,{key:l.pubkey,contact:l,pubkey:l.pubkey,name:l.name},null,8,["contact","pubkey","name"]))),128))]),_:1})]))}}),mt={class:"p-4 box-border"},vt=M({__name:"Follower",props:{pubkey:null,active:{type:Boolean},urls:null},setup(r){const f=r,{pubkey:u,active:i}=T(f),a=v(()=>be(u.value)),m=v(()=>a.value.getList());return Ye(a,i),(o,p)=>(y(),S("div",mt,[s(e(fe),null,{default:c(()=>[(y(!0),S(Q,null,pe(e(m),l=>(y(),R(me,{key:l.pubkey,pubkey:l.pubkey},null,8,["pubkey"]))),128))]),_:1})]))}}),bt=M({__name:"ProfileMoreInfoRelayList",props:{pubkey:null,active:{type:Boolean}},setup(r){const f=r,{pubkey:u}=T(f),i=v(()=>ye(u.value)),a=v(()=>u.value===B.value.publicKey?{readUrl:I.getReadList(),writeUrl:I.getWriteList(),urls:new Set(Object.keys(I.getData()))}:i.value.feat.getReadWriteList()),m=v(()=>{var p;return(p=a.value)==null?void 0:p.urls});function o(){Oe.push({name:"relays"})}return(p,l)=>{var h;const n=N,g=ge;return y(),S(Q,null,[s(g,{show:e(I).hasChange()},{default:c(()=>[s(n,{onClick:o,type:"primary"},{default:c(()=>[P(U(e($)("save")),1)]),_:1})]),_:1},8,["show"]),s(et,{urls:(h=e(m))!=null?h:[],title:""},{right:c(({url:d})=>{var k,w,L,F;return[s(tt,{active:(w=(k=e(a))==null?void 0:k.writeUrl.has(d))!=null?w:!1,class:"mr-1"},null,8,["active"]),s(ot,{active:(F=(L=e(a))==null?void 0:L.readUrl.has(d))!=null?F:!1,class:"mr-2"},null,8,["active"]),s(Ze,{url:d},null,8,["url"])]}),_:1},8,["urls"])],64)}}}),yt=M({__name:"ProfileMoreInfo",props:{pubkey:null,urls:null},setup(r){const f=r,{pubkey:u}=T(f),i=v(()=>[u.value]),a=z("homepage");return(m,o)=>{const p=nt,l=at;return y(),R(l,{type:"line",value:a.value,"onUpdate:value":o[0]||(o[0]=n=>a.value=n),animated:""},{default:c(()=>[s(p,{"display-directive":"show",name:"homepage",tab:e($)("homepage")},{default:c(()=>[s(Xe,{active:a.value==="homepage",pubkeys:e(i),urls:f.urls},null,8,["active","pubkeys","urls"])]),_:1},8,["tab"]),s(p,{"display-directive":"show",name:"follow",tab:e($)("follow")},{default:c(()=>[s(_t,{active:a.value==="follow",pubkey:e(u),urls:r.urls},null,8,["active","pubkey","urls"])]),_:1},8,["tab"]),s(p,{"display-directive":"show:lazy",name:"follower",tab:e($)("follower")},{default:c(()=>[s(vt,{active:a.value==="follower",pubkey:e(u)},null,8,["active","pubkey"])]),_:1},8,["tab"]),s(p,{"display-directive":"show:lazy",name:"\u4E2D\u7EE7",tab:e($)("relay")},{default:c(()=>[s(bt,{active:a.value==="relay",pubkey:e(u)},null,8,["active","pubkey"])]),_:1},8,["tab"])]),_:1},8,["value"])}}}),gt={},ht={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},kt=C("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44",d:"M358.62 129.28L86.49 402.08L70 442l39.92-16.49l272.8-272.13l-24.1-24.1z"},null,-1),wt=C("path",{d:"M413.07 74.84l-11.79 11.78l24.1 24.1l11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44"},null,-1),xt=[kt,wt];function $t(r,f){return y(),S("svg",ht,xt)}const Ft=ne(gt,[["render",$t]]),Et={},Ct={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Lt=C("path",{d:"M384 336a63.78 63.78 0 0 0-46.12 19.7l-148-83.27a63.85 63.85 0 0 0 0-32.86l148-83.27a63.8 63.8 0 1 0-15.73-27.87l-148 83.27a64 64 0 1 0 0 88.6l148 83.27A64 64 0 1 0 384 336z",fill:"currentColor"},null,-1),zt=[Lt];function Bt(r,f){return y(),S("svg",Ct,zt)}const Rt=ne(Et,[["render",Bt]]),St=M({__name:"UserDataEditing",emits:["close"],setup(r,{emit:f}){const u=Ke(),i=z({}),a=v(()=>oe(B.value.publicKey)),m=v(()=>a.value.feat.useMetadata());de(()=>{i.value=m.value});const o=z(!1);async function p(){o.value=!0,a.value.publish({content:JSON.stringify(i.value),kind:0},I.getWriteList(),{addUrl:!0,onOK({ok:l,url:n}){o.value=!1,l?u.success(`\u5DF2\u6210\u529F\u63D0\u4EA4\u5230${n}`):u.error(`\u63D0\u4EA4\u5230${n}\u5931\u8D25`)}})}return(l,n)=>{const g=Ie,h=Ve;return y(),R(h,{class:"w-[600px] max-w-full max-h-full",title:"\u7F16\u8F91\u7528\u6237\u4FE1\u606F",bordered:!1,role:"dialog","aria-modal":"true"},{default:c(()=>[s(e(te),{vertical:""},{default:c(()=>[s(lt,{userMetadata:i.value},null,8,["userMetadata"]),s(e(te),{center:""},{default:c(()=>[s(e(N),{type:"tertiary",onClick:n[0]||(n[0]=()=>f("close"))},{default:c(()=>[P(U(e($)("cancel")),1)]),_:1}),s(g,{trigger:"hover"},{trigger:c(()=>[s(e(N),{type:"primary",onClick:p,loading:o.value,disabled:o.value},{default:c(()=>[P(U(e($)("submit")),1)]),_:1},8,["loading","disabled"])]),default:c(()=>[P(" \u5982\u679C\u52A0\u8F7D\u4E0D\u5230\u5408\u9002\u7684\u4FE1\u606F\uFF0C\u90A3\u53EF\u80FD\u662Frelays\u8BBE\u7F6E\u4E0D\u5BF9\u8BF7\u5C1D\u8BD5\u914D\u7F6E\u4E00\u4E0B ")]),_:1}),o.value?(y(),R(g,{key:0,trigger:"hover"},{trigger:c(()=>[s(e(N),{onClick:n[1]||(n[1]=()=>o.value=!1)},{default:c(()=>[P("\u505C\u6B62\u52A0\u8F7D")]),_:1})]),default:c(()=>[P(" \u5982\u679C\u60A8\u662F\u65B0\u7528\u6237\u7684\u8BDD\uFF0C\u6216\u8005\u60A8\u653E\u5F03\u4E4B\u524D\u7684\u4FE1\u606F\u5C31\u53EF\u4EE5\u70B9\u6B64\u5904 ")]),_:1})):K("",!0)]),_:1})]),_:1})]),_:1})}}}),Pt=M({__name:"UserInformationButton",props:{pubkey:null},setup(r){const f=r,{pubkey:u}=T(f),i=rt(),a=v(()=>u.value===B.value.publicKey),m=z(!1),o=he(),p=ke(),l=z([a.value&&{label:$("edit_user_profile"),key:"editProfile",icon:se(Ft),props:{onclick(){m.value=!m.value}}},{label:$("copy"),key:"clipboard",icon:se(Rt),children:[{label:`${$("copy")} npub`,key:"copy-npub",props:{onclick(){const n=Y.npubEncode(B.value.publicKey);i(n)}}},{label:`${$("copy")} nprofile`,key:"copy-npro",props:{onclick(){const n=Y.nprofileEncode({pubkey:B.value.publicKey,relays:[...I.getWriteList()]});i(n)}}},a.value&&{label:`${$("copy")} nsec`,key:"copy-nsec",props:{onclick(){const n=Y.nsecEncode(B.value.privateKey);i(n)}}},{label:`${$("copy")} publicKey hex`,key:"copy-hex",props:{onclick(){i(B.value.publicKey)}}}].filter(n=>!!n)},{label:$("recommend_user"),key:"recommendUser",props:{onclick(){o(u.value)}}},{label:$("recommend_metadata"),key:"recommendUserMetadata",props:{onclick(){p(u.value)}}}].filter(n=>!!n));return(n,g)=>{const h=N,d=st,k=Ae;return y(),S(Q,null,[s(d,{placement:"bottom-start",trigger:"click",options:l.value},{default:c(()=>[s(h,{circle:"",type:"info"},{default:c(()=>[s(we)]),_:1})]),_:1},8,["options"]),s(k,{show:m.value,"onUpdate:show":g[1]||(g[1]=w=>m.value=w)},{default:c(()=>[s(St,{onClose:g[0]||(g[0]=()=>m.value=!1)})]),_:1},8,["show"])],64)}}}),Mt={key:0,class:"w-full h-full flex flex-col"},jt={class:"flex flex-col"},Dt={class:"flex items-center justify-end px-8 mt-4"},Ut={key:1},Ot={class:"flex items-center"},Kt={class:"w-full",style:{"word-break":"break-all","text-overflow":"ellipsis","word-wrap":"break-word"}},It=M({__name:"ProfileView",setup(r){const f=Te(),u=Y.nprofileEncode({pubkey:B.value.publicKey,relays:Array.from(I.getWriteList())}),i=v(()=>{var d;return(d=f.params.value)!=null?d:u}),a=v(()=>ut(i.value)),m=v(()=>{var d;return((d=a.value)==null?void 0:d.pubkey)===B.value.publicKey}),o=v(()=>{var d;return(d=a.value)==null?void 0:d.pubkey}),p=v(()=>{var d,k;return((d=a.value)==null?void 0:d.relays)&&new Set((k=a.value)==null?void 0:k.relays)}),l=v(()=>o.value?oe(o.value,{urls:p.value}).feat.useMetadata():null),n=v(()=>o.value?q.isFollow(o.value):!1);function g(){!o.value||(n.value?q.unFollow(o.value):q.follow(o.value))}const[h]=Ge(.3);return(d,k)=>{const w=We,L=_e,F=N,j=te;return e(o)?(y(),S("div",Mt,[s(Qe,{class:"flex-shrink flex-1 h-0",refreshable:"",loadable:""},{default:c(()=>{var D,t,_,x,b,E,V,O,A;return[C("div",jt,[C("div",{ref_key:"target",ref:h,class:"h-0 w-full relative flex-shrink-0",style:{}},[((_=(D=e(l))==null?void 0:D.banner)!=null?_:(t=e(l))==null?void 0:t.picture)?(y(),R(w,{key:0,src:(E=(x=e(l))==null?void 0:x.banner)!=null?E:(b=e(l))==null?void 0:b.picture,"object-fit":"cover",class:"w-full h-full banner"},null,8,["src"])):K("",!0),s(L,{class:"absolute bottom-0 left-2",style:Ne({transform:"translate(0,50%)"}),round:"",size:100,src:(O=(V=e(l))==null?void 0:V.picture)!=null?O:e(ue)},null,8,["style","src"])],512),C("div",null,[C("div",Dt,[s(j,null,{default:c(()=>[e(m)?K("",!0):(y(),R(F,{key:0,class:"ml-4",strong:"",round:"",type:e(n)?"warning":"primary",onClick:g},{default:c(()=>[P(U(e(n)?"UnFollow":"Follow"),1)]),_:1},8,["type"])),e(o)?(y(),S("div",Ut,[s(Pt,{pubkey:e(o)},null,8,["pubkey"])])):K("",!0)]),_:1})]),C("h1",Ot,[s(ie,null,{default:c(()=>{var H,G,J;return[P(U((J=(H=e(l))==null?void 0:H.name)!=null?J:(G=e(a))==null?void 0:G.pubkey.slice(0,10)),1)]}),_:1})]),C("div",Kt,U((A=e(l))==null?void 0:A.about),1)])]),e(o)?(y(),R(yt,{key:0,pubkey:e(o),urls:e(p)},null,8,["pubkey","urls"])):K("",!0)]}),_:1})])):K("",!0)}}});const zo=ne(It,[["__scopeId","data-v-5fb6d0db"]]);export{zo as default};
